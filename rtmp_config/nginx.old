# This file is symlinked to ~/usr/local/nginx/conf/nginx.conf
# Must use sudo to save changes

# No worker processes adjusted based on no CPU cores
worker_processes  auto;

# Number of simultaneous connections
events {
    worker_connections  1024;
}

http {
    # HLS server block
server {
        listen 8080;  # HTTP port for serving HLS
        location /live {
            # Serve HLS files
            types {
                application/vnd.apple.mpegurl m3u8;
                video/mp2t ts;
            }

            # Directory for HLS segments and playlists
            root /home/nolan/Edge-SDK/rtmp_config;  # Adjust this as needed
            add_header Cache-Control no-cache;
        }
    }
}

# RTMP server configuration
rtmp {
    server {
        listen 1935;

        application live {
            live on;
            hls on;  # Enable HLS
            hls_path /home/nolan/Edge-SDK/rtmp_config;  # Path for HLS segments
            hls_fragment 5s;  # Duration of each segment
            hls_playlist_length 60s;  # Length of the playlist
            record off;
        }
    }
}
